#include <stdlib.h>
#include <stdio.h>
#include <string.h>

/*
 * compiled with:
 * gcc -O0 -fno-stack-protector -o easy -mpreferred-stack-boundary=2 -z execstack easy.c
 * run with:
 * socat TCP4-LISTEN:7901,tcpwrap=script,reuseaddr,fork EXEC:./easy
 */

int main(int argc, char** argv)
{
  int canary = 0x11223344;
  char buff[10];
  printf("Buff Location:%08X\n",buff);
  gets(buff);
  if (canary != 0x11223344)
  {
    printf("Stack smashing detected! Exiting!\n");
    exit(-1);
  }
  return (int)&buff;
}

